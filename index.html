<!-- Add after chat-container -->
<div class="video-container" style="margin-top:10px; text-align:center;">
  <video id="localVideo" autoplay playsinline muted style="width:180px; border-radius:8px;"></video>
  <video id="remoteVideo" autoplay playsinline style="width:180px; border-radius:8px; margin-left:10px;"></video>
  <br />
  <button id="callBtn" style="margin-top:8px; padding:8px 16px; border:none; border-radius:6px; background:#0084ff; color:#fff; cursor:pointer;">ðŸŽ¥ Start Call</button>
</div>

<script>
  const localVideo = document.getElementById("localVideo");
  const remoteVideo = document.getElementById("remoteVideo");
  const callBtn = document.getElementById("callBtn");

  let pc;

  async function startCall() {
    pc = new RTCPeerConnection();

    // local stream
    const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
    localVideo.srcObject = stream;
    stream.getTracks().forEach(track => pc.addTrack(track, stream));

    // remote stream
    pc.ontrack = (event) => {
      remoteVideo.srcObject = event.streams[0];
    };

    // ICE
    pc.onicecandidate = (event) => {
      if (event.candidate) {
        socket.emit("ice-candidate", event.candidate);
      }
    };

    // create offer
    const offer = await pc.createOffer();
    await pc.setLocalDescription(offer);
    socket.emit("offer", offer);
  }

  socket.on("offer", async (offer) => {
    pc = new RTCPeerConnection();

    const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
    localVideo.srcObject = stream;
    stream.getTracks().forEach(track => pc.addTrack(track, stream));

    pc.ontrack = (event) => {
      remoteVideo.srcObject = event.streams[0];
    };

    pc.onicecandidate = (event) => {
      if (event.candidate) {
        socket.emit("ice-candidate", event.candidate);
      }
    };

    await pc.setRemoteDescription(new RTCSessionDescription(offer));
    const answer = await pc.createAnswer();
    await pc.setLocalDescription(answer);
    socket.emit("answer", answer);
  });

  socket.on("answer", async (answer) => {
    await pc.setRemoteDescription(new RTCSessionDescription(answer));
  });

  socket.on("ice-candidate", async (candidate) => {
    try {
      await pc.addIceCandidate(new RTCIceCandidate(candidate));
    } catch (err) {
      console.error("ICE error:", err);
    }
  });

  callBtn.onclick = startCall;
</script>
